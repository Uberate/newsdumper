FROM golang:1.19 as builder

COPY . .

CMD ["make", "build"]

FROM alpine:3.16

WORKDIR /app

COPY --from=builder output/newsdumper /app/newsdumper

ENV DUMP_PATH="/var/newsdumper/"

RUN ["bash", "-c ", "mkdir -p $DUMP_PATH && ./newsdumper -dump-path $DUMP_PATH"]